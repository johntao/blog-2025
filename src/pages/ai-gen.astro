---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Fetch posts from all author collections
const author1Posts = await getCollection('author1');
const author2Posts = await getCollection('author2');
const author3Posts = await getCollection('author3');

// Combine all posts and filter by tag
const allPosts = [...author1Posts, ...author2Posts, ...author3Posts];
const posts = allPosts
  .filter(post => post.data.tags.includes('ai-generated'))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout title="Posts Tag: AI-Generated">
  <h2>Posts Tagged: AI-Generated</h2>

  {posts.map((post, index) => (
    <>
      <article>
        <h3><a href={`/posts/${post.slug}`}>{post.data.title}</a></h3>
        <p><em>Published: {post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</em></p>
        <p>{post.data.description}</p>
      </article>

      {index < posts.length - 1 && <hr />}
    </>
  ))}
</BaseLayout>
