---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Fetch posts from all collections
const defaultPosts = await getCollection('default');
const aiGeneratedPosts = await getCollection('ai-generated');

// Combine all posts and sort by date
const allPosts = [...defaultPosts, ...aiGeneratedPosts];
const posts = allPosts.sort((a, b) => {
  const dateComparison = b.data.pubDate.valueOf() - a.data.pubDate.valueOf();
  if (dateComparison !== 0) return dateComparison;
  return b.data.title.localeCompare(a.data.title);
});
---

<BaseLayout title="All Posts" cls="list0">
  <h2>All Posts</h2>

  <h3>2025</h3>
  <ul>
    {posts.map(post => (
      <li>
        <strong>{post.data.pubDate.toLocaleDateString('en-US', { month: '2-digit', day: '2-digit' })}</strong> <a href={`/posts/${post.slug}`}>{post.data.title}</a>
      </li>
    ))}
  </ul>
</BaseLayout>
